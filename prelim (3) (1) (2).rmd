---
title: "Are 'High Tax' States Better Places to Live?"
author: "Pratyush Jha, Paul Atadja, Xinhao Wang"
date: "`r Sys.Date()`"
output:
  html_document:
    code_folding: show
    fig_width: 12
    fig_height: 6

---

# Introduction

This project explores whether U.S. states with higher tax collections per capita
tend to be better places to live, as measured by the Human Development Index (HDI).
This question is politically and socially relevant because of ongoing debates
about “high-tax” versus “low-tax” states.

The analysis combines tax revenue data and HDI data from two separate sources; The Tax Foundation and UNData.
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(stringr)
library(ggplot2)
library(ggrepel)
```

```{r}

# Import Tax Data
saltpc <- read_csv("saltpc.csv") %>%
rename(Tax_PC = `Collections per Capita`) %>%
filter(State != "United States")
```

```{r}
# Import State HDI Data

shdi <- read_csv("statesbyhdicv.csv") %>%
rename(HDI = Value)
```

```{r}
# Check column names, Join

colnames(saltpc)
colnames(shdi)
state_df <- inner_join(saltpc, shdi, by = "State")
```
```{r}
# 'Tax_PC' was stored as a string, convert to numeric

state_df <- state_df %>%
mutate(Tax_PC = as.numeric(str_replace_all(Tax_PC, "[$,]", "")))
```
```{r}
# Save tidy dataset
write_csv(state_df, "tidy_state_tax_hdi.csv")
```
```{r}
# View merged 
head(state_df)
```
```{r}
#summary statistics table
summary_table <- state_df %>%
summarise(
Mean_Tax_PC = mean(Tax_PC, na.rm = TRUE),
SD_Tax_PC = sd(Tax_PC, na.rm = TRUE),
Min_Tax_PC = min(Tax_PC, na.rm = TRUE),
Max_Tax_PC = max(Tax_PC, na.rm = TRUE),
Mean_HDI = mean(HDI, na.rm = TRUE),
SD_HDI = sd(HDI, na.rm = TRUE),
Min_HDI = min(HDI, na.rm = TRUE),
Max_HDI = max(HDI, na.rm = TRUE)
)

knitr::kable(summary_table, caption = "Summary Statistics for Tax Revenue and HDI")
```
```{r}
# Correlation Test
cor_test <- cor.test(state_df$Tax_PC, state_df$HDI, method = "pearson")
cor_test
```

```{r}
# Scatterplot with Regression Line
model <- lm(HDI ~ Tax_PC, data = state_df)

r  <- round(cor(state_df$Tax_PC, state_df$HDI), 3)
r2 <- round(summary(model)$r.squared, 3)
p  <- signif(cor.test(state_df$Tax_PC, state_df$HDI)$p.value, 3)

ggplot(state_df, aes(x = Tax_PC, y = HDI, label = State)) +
  geom_point(size = 3) +
  geom_smooth(method = "lm", se = TRUE) +
  geom_text_repel(size = 3, max.overlaps = 20) +
  labs(
    title = "HDI vs State Tax Revenue per Capita",
    subtitle = paste0("r = ", r, ", R² = ", r2, ", p = ", p),
    x = "Tax Revenue per Capita ($)",
    y = "HDI"
  ) +
  theme_minimal()
```

## Interpretation of results

The correlation coefficient of r = 57 indicates a moderate strong positive relationship between tax revenue and HDI. The p value in (1.109e-05) confirms the relationship is statistically significant.The regression model of R^2 = 0.33 means that about 33% of the variation in HDI can be explained in differences in tax revenue per capita.

## Limitations

Although there is a positive association, the analysis has some limitations

 - Correlation is not causation, higher taxes doesn't cause better quality of life
 
 - Reverse causality may exist
 
 - states with wealthier populations may collect higher taxes due to higher income
 
 - Tax revenue doesn't capture spending efficiency - two states may collect similar revenue but spends it differently

 - HDI components evolve slowly and reflects on decades rather than current tax policy

 - Factors not included such as healthcare access, education spending, cost of living and urbanization may also play major roles in determining HDI

## Discussion 
The results show a moderate positive correlation (r ≈ 0.57) between
state tax revenue per capita and HDI. This suggests that states which
collect more taxes per person tend to have better overall quality-of-life
outcomes. However, this does not imply causation. Higher HDI may lead to higher
incomes and higher tax bases rather than the reverse. Additionally,
other variables such as education spending, healthcare access, and
urbanization likely play major roles.